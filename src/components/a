// components/AddProduct.jsx
import React, { useState } from "react";
import collections from "../data/collections.json";
import expansions from "../data/expansions.json";
import productTypes from "../data/productTypes.json";

export default function AddProduct({ onProductAdd }) {
  const [form, setForm] = useState({
    name: "",
    price: "",
    image: "",
    collectionId: "",
    expansionId: "",
    productTypeId: "",
    description: "",
    stock: 0,
    limitPerCustomer: 1,
    preorder: false,
    releaseDate: "",
    available: true
  });

  const handleChange = (e) => {
    const { name, value, type, checked } = e.target;
    setForm({
      ...form,
      [name]: type === "checkbox" ? checked : value
    });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    const newProduct = {
      ...form,
      id: Date.now(),
      price: parseFloat(form.price),
      stock: parseInt(form.stock),
      limitPerCustomer: parseInt(form.limitPerCustomer),
      images: [form.image],
      available: form.available === "true" || form.available === true
    };
    console.log("Producto agregado:", newProduct);
    onProductAdd?.(newProduct);
    setForm({
      name: "",
      price: "",
      image: "",
      collectionId: "",
      expansionId: "",
      productTypeId: "",
      description: "",
      stock: 0,
      limitPerCustomer: 1,
      preorder: false,
      releaseDate: "",
      available: true
    });
  };

  return (
    <div style={{ maxWidth: "600px", margin: "40px auto", background: "#2a2f34", padding: "24px", borderRadius: "12px" }}>
      <h2 style={{ color: "white", marginBottom: "20px", textAlign: "center" }}>Registrar nuevo producto</h2>
      <form onSubmit={handleSubmit}>
        <input name="name" placeholder="Nombre" value={form.name} onChange={handleChange} style={inputStyle} />
        <input name="price" type="number" placeholder="Precio" value={form.price} onChange={handleChange} style={inputStyle} />
        <input name="image" placeholder="URL de imagen" value={form.image} onChange={handleChange} style={inputStyle} />

        <select name="collectionId" value={form.collectionId} onChange={handleChange} style={inputStyle}>
          <option value="">Seleccionar colección</option>
          {collections.map(col => <option key={col.id} value={col.id}>{col.name}</option>)}
        </select>

        <select name="expansionId" value={form.expansionId} onChange={handleChange} style={inputStyle}>
          <option value="">Seleccionar expansión</option>
          {expansions.map(exp => <option key={exp.id} value={exp.id}>{exp.name}</option>)}
        </select>

        <select name="productTypeId" value={form.productTypeId} onChange={handleChange} style={inputStyle}>
          <option value="">Seleccionar tipo de producto</option>
          {productTypes.map(type => <option key={type.id} value={type.id}>{type.name}</option>)}
        </select>

        <textarea name="description" placeholder="Descripción" value={form.description} onChange={handleChange} rows="3" style={inputStyle} />
        <input name="stock" type="number" placeholder="Stock" value={form.stock} onChange={handleChange} style={inputStyle} />
        <input name="limitPerCustomer" type="number" placeholder="Límite por cliente" value={form.limitPerCustomer} onChange={handleChange} style={inputStyle} />
        <input name="releaseDate" type="date" placeholder="Fecha de lanzamiento" value={form.releaseDate} onChange={handleChange} style={inputStyle} />

        <label style={{ color: "#ccc", display: "block", marginBottom: "8px" }}>
          <input type="checkbox" name="preorder" checked={form.preorder} onChange={handleChange} /> Preventa
        </label>

        <label style={{ color: "#ccc", display: "block", marginBottom: "16px" }}>
          <input type="checkbox" name="available" checked={form.available} onChange={handleChange} /> Disponible
        </label>

        <button type="submit" className="buy-button" style={{ width: "100%", padding: "12px" }}>
          Agregar producto
        </button>
      </form>
    </div>
  );
}

const inputStyle = {
  width: "100%",
  padding: "10px",
  borderRadius: "8px",
  border: "1px solid #444",
  background: "#1e1f26",
  color: "white",
  fontSize: "14px",
  marginBottom: "16px"
};
